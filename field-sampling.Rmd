---
title: "Field Sampling"
author: "Paige Amos"
date: "31/10/2021"
output: pdf_document
---

```{r}
library(tidyverse)
library(here)
```

```{r}
biodiversity = read_csv(here("./data/biodiversity.csv"))
knitr::kable(biodiversity, caption = "Biodiversity of invertebrates on various substrates")

cover = read_csv(here("./data/cover.csv"))
knitr::kable(biodiversity, caption = "Cover data")

quadrat = read_csv(here("./data/quadrat.csv"))
knitr::kable(biodiversity, caption = "Quadrat data")
```

```{r}
merged_data_1 = merge(biodiversity, cover)
head(merged_data_1)

merged_data_1 <- merged_data_1 %>%
  select(-c(biotic_hab, per_mussel, per_barnacle, per_upright, per_crust, num_snail, num_crab))


#number of individuals per species in the 10 squares
quad_shannon <- biodiversity %>%
  drop_na(n) %>%
  group_by (vertical_transect, quadrat, species) %>%
  summarize(n_per_species = sum(n))

#total number of individuals of all species in quadrat found in the 10 squares
quad_total <- biodiversity %>%
  drop_na(species, n) %>%
  group_by(vertical_transect, quadrat) %>%
  summarize(n_total_per_quadrat = sum(n))

quad_shannon <- merge(quad_shannon, quad_total, all = TRUE, by = c('vertical_transect', 'quadrat'))

quad_shannon <- quad_shannon %>%
  drop_na(species) %>%
  mutate(p_i = n_per_species/n_total_per_quadrat) %>%
  mutate(Pi_lnPi = p_i*log(p_i))

#calulating shannon wiener for each quadrat and adding to merged data
shannon_index <- quad_shannon %>%
  group_by(vertical_transect, quadrat) %>%
  summarize(H = -sum(Pi_lnPi))

merged_data_2 <- merge(quad_shannon, cover)
merged_data_3 <- merge(merged_data, shannon_index)


```

```{r}
quad_biodiversity <- biodiversity %>%
  drop_na(n) %>%
  group_by(vertical_transect, quadrat) %>%
  summarize(n_spp = length(unique(species)))

species_biodiversity <- biodiversity %>%
  drop_na(species, n) %>%
  select(species, abiotic_hab) %>%
  group_by(abiotic_hab) %>%
  summarize(n_spp = length(unique(species)))
  
prop_biodiversity <- biodiversity %>%
  drop_na(species,n) %>%
  select(-c(species, n, biotic_hab)) %>%
  group_by(vertical_transect, quadrat, square) %>%
  summarize(proportion = )
  
```

make boxplot of species richness for each substrate type
